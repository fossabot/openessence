<!-- applied query string TODO: determine final styling other than hijacking nav bar space-->
<div class="col-md-12 input-group" style="margin-top:-21px; margin-bottom:5px;">
  <!-- search button -->
  <input class="form-control" id="query-string" name="queryString" ng-model="queryString" type="text">
  <span class="input-group-btn">
    <button type="button" class="btn btn-default"><span class="icon-search"></span></button>
  </span>
</div>

<!-- filters -->
<div class="col-md-12">
  <div class="list-group col-md-3" ng-repeat="f in filters">
    <!-- do we template these into separate partials or will directives take care of it?, also, looks very OE-ee -->
    <div ng-switch on="f.type">
      <div class="panel panel-default filter-panel" ng-switch-when="text">
        <div class="panel-heading condensed">
          <div class="clearfix">
            <button type="button" class="close" ng-click="removeFilter(f)"><span class="icon-cancel"></span></button>
            {{f.name}}
          </div>
        </div>
        <div class="panel-body">
          <form class="form" role="form">
            <div class="form-group">
              <input class="form-control" id="{{f.id}}" name="{{f.name}}" ng-model="f.filterValue" type="text"
                     placeholder="{{f.placeHolder}}">
            </div>
          </form>
        </div>
      </div>
      <div class="panel panel-default filter-panel" ng-switch-when="select"> <!-- TODO they all share this header -->
        <div class="panel-heading condensed">
          <div class="clearfix">
            <button type="button" class="close" ng-click="removeFilter(f)"><span class="icon-cancel"></span></button>
            {{f.name}}
          </div>
        </div>
        <div class="panel-body">
          <form class="form" role="form">
            <div class="form-group">
              <!-- TODO validation -->
              <select class="form-control" ng-model="f.filterValue" ng-options="o for o in f.possibleValues"></select>
            </div>
          </form>
        </div>
      </div>
      <div class="panel panel-default filter-panel" ng-switch-when="dateRange">
        <div class="panel-heading condensed">
          <div class="clearfix">
            <button type="button" class="close" ng-click="removeFilter(f)"><span class="icon-cancel"></span></button>
            {{f.name}}
          </div>
        </div>
        <div class="panel-body">
          <form class="form-inline" role="form">
            <div class="form-group">
              <!-- TODO validation -->
              <input class="form-control" name="{{f.id + 'Start'}}" ng-model="f.filterValue.start"
                     type="text" datepicker-popup show-weeks="false" placeholder="{{strings.start}}">
            </div>
            <div class="form-group">
              <input class="form-control" name="{{f.id + 'End'}}" ng-model="f.filterValue.end" type="text"
                     datepicker-popup show-weeks="false" placeholder="{{strings.end}}">
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- add button-->
  <div class="btn-group">
    <button id="addFilterModelBtn" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" type="button">
      <span class="icon-plus"></span>
    </button>
    <ul class="dropdown-menu" role="menu" aria-labelledby="addFilterModelBtn">
      <li ng-repeat="(key, value) in possibleFilterConfigs">
        <a ng-click="addFilter(value)">{{key}}</a>
      </li>
    </ul>
  </div>
</div>

<!-- visualizations -->
<div class="container">
  <div class="row" ng-repeat="row in rows">
    <!-- track by viz.id to preserve state when we delete a grid element -->
    <div class="col-md-6" ng-repeat="viz in row track by viz.id" ng-switch="viz.plus">
      <button type="button" class="btn btn-primary btn-lg" ng-switch-when="true" ng-click="addVisualization()">
        <span class="icon-plus"></span>
      </button>
      <outpatient-visualization filters="filters" on-close="removeVisualization($parent.$parent.$index, $index)"
                                ng-switch-default></outpatient-visualization>
    </div>
  </div>
</div>
