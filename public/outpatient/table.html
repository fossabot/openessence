<div class="table-responsive">
  <table class="table table-striped table-hover table-condensed" frable="tableParams">
    <tr ng-repeat="visit in $data">

      <td data-title="strings.date" sortable="'reportDate'">
        <a ng-click="tableFilter('date', visit._source.reportDate)">{{visit._source.reportDate | date}}</a>
      </td>
      <td data-title="strings.district" sortable="'medicalFacility.district.raw'">
        <a ng-click="tableFilter('districts', visit._source.medicalFacility.district)">
          {{visit._source.medicalFacility.district}}
        </a>
      </td>

      <td data-title="strings.symptoms">
        <a ng-click="tableFilter('symptoms', visit._source.symptoms)">{{visit._source.symptoms | join |
          truncate:30}}</a>
      </td>
      <td data-title="strings.diagnoses">
        <a ng-click="tableFilter('diagnoses', visit._source.diagnoses)">{{visit._source.diagnoses | join |
          truncate:30}}</a>
      </td>

      <td data-title="strings.sex" sortable="'patient.sex'">
        <a ng-click="tableFilter('sex', visit._source.patient.sex)">{{visit._source.patient.sex}}</a>
      </td>
      <td data-title="strings.age" sortable="'patient.age'">
        <a ng-click="tableFilter('age', visit._source.patient.age)">{{visit._source.patient.age}}</a>
      </td>

      <!-- TODO we probably don't need most of these columns -->
      <td data-title="strings.weight" sortable="'patient.weight'">
        <a ng-click="tableFilter('weight', visit._source.patient.weight)">{{visit._source.patient.weight}}
          <!-- TODO this might not be the best way to abstract units -->
          <span ng-show="visit._source.patient.weight" translate>kg</span>
        </a>
      </td>
      <td data-title="strings.bloodPressure" ng-if="!condensed"><!-- TODO ng-if doesn't work -->
        {{visit._source.patient.bloodPressure.systolic}}
        <span ng-show="visit._source.patient.bloodPressure.systolic || visit._source.patient.bloodPressure.diastolic">
          /
        </span>
        {{visit._source.patient.bloodPressure.diastolic}}
      </td>
      <td data-title="strings.pulse" sortable="'patient.pulse'">
        <a ng-click="tableFilter('pulse', visit._source.patient.pulse)">{{visit._source.patient.pulse}}
          <span ng-show="visit._source.patient.pulse" translate>BPM</span>
        </a>
      </td>
      <td data-title="strings.temperature" sortable="'patient.temperature'">
        <a ng-click="tableFilter('temperature', visit._source.patient.temperature)">{{visit._source.patient.temperature}}
          <span ng-show="visit._source.patient.temperature" translate>Â°C</span>
        </a>
      </td>

      <!-- TODO check or X icon instead of true/false -->
      <td data-title="strings.returnVisit" sortable="'returnVisit'">{{visit._source.returnVisit}}</td>

      <td data-title="strings.patientId" sortable="'patient.patientId'">{{visit._source.patient.patientId}}</td>

      <!-- TODO this column has no business being here -->
      <td data-title="strings.oeId" sortable="'oeId'">{{visit._source.oeId}}</td>

      <!-- Edit controls, they're floated right to offset them from the rest of the table -->
      <td data-title="strings.edit">
        <div class="btn-group btn-group-xs edit-controls">
          <button type="button" class="btn btn-default" ng-click="editVisit(visit)">
            <span class="icon-pencil"></span>
          </button>
          <button type="button" class="btn btn-danger" ng-click="deleteVisit(visit)">
            <span class="icon-trash"></span>
          </button>
        </div>
      </td>

    </tr>
  </table>
</div>
